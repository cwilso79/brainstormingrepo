<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moody's for Compliance - Sales Configurator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --navy-dark: #0b2545;
            --navy-blue: #1b4e85;
            --teal: #2aa198;
            --amber: #ffb020;
            --red: #e74c3c;
            --green: #27ae60;
        }
        
        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
            background: linear-gradient(135deg, var(--navy-dark) 0%, var(--navy-blue) 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 18px;
            opacity: 0.9;
        }
        
        .configurator {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .progress-bar {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }
        
        .progress-step {
            flex: 1;
            padding: 20px;
            text-align: center;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .progress-step.active {
            background: var(--navy-blue);
            color: white;
        }
        
        .progress-step.completed {
            background: var(--green);
            color: white;
        }
        
        .progress-step:not(:last-child)::after {
            content: '‚Üí';
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            color: #cbd5e0;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .progress-step.active .step-number,
        .progress-step.completed .step-number {
            background: rgba(255,255,255,0.9);
            color: var(--navy-blue);
        }
        
        .content {
            padding: 40px;
            min-height: 500px;
        }
        
        .step-content {
            display: none;
        }
        
        .step-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h2 {
            color: #1a202c;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #718096;
            font-size: 16px;
            margin-bottom: 30px;
        }
        
        .question-group {
            margin-bottom: 30px;
        }
        
        .question-label {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
            display: block;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        input[type="number"],
        input[type="text"] {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus {
            outline: none;
            border-color: var(--navy-blue);
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .checkbox-card {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
        }
        
        .checkbox-card:hover {
            border-color: var(--navy-blue);
            background: #f7fafc;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
        }
        
        .checkbox-card.selected {
            border-color: var(--navy-blue);
            background-color: #eef2ff;
            border-width: 3px;
            padding: 19px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .checkbox-card input[type="checkbox"] {
            margin-right: 10px;
        }
        
        .checkbox-card label {
            font-weight: 600;
            color: #2d3748;
            cursor: pointer;
            display: block;
            margin-bottom: 5px;
        }
        
        .checkbox-card .description {
            font-size: 14px;
            color: #718096;
            margin-top: 5px;
        }
        
        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .radio-card {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            user-select: none;
        }
        
        .radio-card:hover {
            border-color: var(--navy-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .radio-card.selected {
            border-color: var(--navy-blue);
            background: #eef2ff;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            transform: translateY(-2px);
        }
        
        .radio-card input[type="radio"] {
            display: none;
        }
        
        .radio-card .title {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }
        
        .radio-card .price {
            font-size: 24px;
            font-weight: 700;
            color: var(--navy-blue);
            margin: 10px 0;
        }
        
        .radio-card .description {
            font-size: 13px;
            color: #718096;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e2e8f0;
        }
        
        .btn {
            padding: 14px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--navy-blue);
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }
        
        .btn-secondary:hover {
            background: #cbd5e0;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .summary-section {
            background: #f7fafc;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }
        
        .summary-section h3 {
            color: #2d3748;
            font-size: 20px;
            margin-bottom: 15px;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .summary-item:last-child {
            border-bottom: none;
        }
        
        .summary-label {
            color: #4a5568;
            font-weight: 500;
        }
        
        .summary-value {
            color: #2d3748;
            font-weight: 600;
        }
        
        .pricing-card {
            background: linear-gradient(135deg, var(--navy-blue) 0%, var(--navy-dark) 100%);
            color: white;
            border-radius: 12px;
            padding: 30px;
            margin: 25px 0;
        }
        
        .pricing-card h3 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .pricing-breakdown {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .pricing-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        
        .pricing-row.total {
            background: rgba(255,255,255,0.2);
            font-size: 20px;
            font-weight: 700;
            margin-top: 10px;
        }
        
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .alert-info {
            background: #bee3f8;
            color: #2c5282;
            border-left: 4px solid #3182ce;
        }
        
        .alert-warning {
            background: #fefcbf;
            color: #744210;
            border-left: 4px solid #d69e2e;
        }
        
        .consumption-preview {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .consumption-preview h4 {
            color: #2d3748;
            margin-bottom: 15px;
        }
        
        .consumption-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            font-size: 14px;
        }
        
        .consumption-item .label {
            color: #4a5568;
        }
        
        .consumption-item .value {
            color: #2d3748;
            font-weight: 600;
        }
        
        .final-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .final-actions .btn {
            flex: 1;
        }
        
        .btn-success {
            background: var(--green);
            color: white;
        }
        
        .btn-success:hover {
            background: #38a169;
        }
        
        .help-text {
            font-size: 14px;
            color: #718096;
            margin-top: 8px;
            font-style: italic;
        }
        
        .tier-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .tier-professional {
            background: #bee3f8;
            color: #2c5282;
        }
        
        .tier-business {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .tier-scale {
            background: #feebc8;
            color: #7c2d12;
        }
        
        .tier-enterprise {
            background: #fed7d7;
            color: #742a2a;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Moody's for Compliance</h1>
            <p>Sales Configurator - Access Package + Usage Allowance</p>
        </div>
        
        <!-- Disclaimer Banner -->
        <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 8px; padding: 12px 20px; margin-bottom: 20px; text-align: center;">
            <strong style="color: #92400e;">‚ö†Ô∏è ILLUSTRATIVE ONLY:</strong>
            <span style="color: #78350f;"> All pricing, rates, and calculations in this configurator are for illustration purposes only and do not represent actual commercial terms.</span>
        </div>
        
        <div class="configurator">
            <div class="progress-bar">
                <div class="progress-step active" data-step="1">
                    <div class="step-number">1</div>
                    <div>Profile</div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="step-number">2</div>
                    <div>Capabilities</div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="step-number">3</div>
                    <div>Access</div>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="step-number">4</div>
                    <div>Volume</div>
                </div>
                <div class="progress-step" data-step="5">
                    <div class="step-number">5</div>
                    <div>Quote</div>
                </div>
                <div class="progress-step" data-step="6">
                    <div class="step-number">6</div>
                    <div>ROI</div>
                </div>
            </div>
            
            <div class="content">
                <!-- Step 1: Customer Profile -->
                <div class="step-content active" data-step="1">
                    <h2>Customer Profile</h2>
                    <p class="subtitle">Tell us about the customer to calculate appropriate pricing</p>
                    
                    <div class="question-group">
                        <label class="question-label">Customer Size (Revenue / AUM / Total Assets)</label>
                        <div class="radio-group" style="grid-template-columns: repeat(4, 1fr);">
                            <div class="radio-card" onclick="selectCustomerSize('small')">
                                <input type="radio" name="customerSize" value="small" id="size-small">
                                <div class="title">Under $1B</div>
                            </div>
                            <div class="radio-card" onclick="selectCustomerSize('medium')">
                                <input type="radio" name="customerSize" value="medium" id="size-medium">
                                <div class="title">$1B ‚Äì $10B</div>
                            </div>
                            <div class="radio-card" onclick="selectCustomerSize('large')">
                                <input type="radio" name="customerSize" value="large" id="size-large">
                                <div class="title">$10B ‚Äì $50B</div>
                            </div>
                            <div class="radio-card" onclick="selectCustomerSize('xlarge')">
                                <input type="radio" name="customerSize" value="xlarge" id="size-xlarge">
                                <div class="title">Over $50B</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question-group">
                        <label class="question-label">Geographic Scope</label>
                        <div class="radio-group" style="grid-template-columns: repeat(2, 1fr);">
                            <div class="radio-card" onclick="selectRegion('single')">
                                <input type="radio" name="region" value="single" id="region-single">
                                <div class="title">Single Region</div>
                                <div class="description">Operations in one geographic region</div>
                            </div>
                            <div class="radio-card" onclick="selectRegion('multi')">
                                <input type="radio" name="region" value="multi" id="region-multi">
                                <div class="title">Multi-Region</div>
                                <div class="description">Operations across multiple regions</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" disabled>‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep()">Next ‚Üí</button>
                    </div>
                </div>
                
                <!-- Step 2: Use Case -->
                <div class="step-content" data-step="2">
                    <h2>What's the Primary Use Case?</h2>
                    <p class="subtitle">Select all compliance capabilities the customer needs</p>
                    
                    <div class="question-group">
                        <div class="checkbox-group">
                            <div class="checkbox-card" onclick="toggleCheckbox('usecase-entity')">
                                <input type="checkbox" id="usecase-entity" value="entity">
                                <label for="usecase-entity">Standard Entity Data & Verification</label>
                                <div class="description">Corporate structure, beneficial owners, entity profiles</div>
                            </div>
                            <div class="checkbox-card" onclick="toggleCheckbox('usecase-registry')">
                                <input type="checkbox" id="usecase-registry" value="registry">
                                <label for="usecase-registry">Enhanced Entity Data Verification</label>
                                <div class="description">Entity information from live registers combined with our curated entity data in a waterfall format</div>
                            </div>
                            <div class="checkbox-card" onclick="toggleCheckbox('usecase-screening')">
                                <input type="checkbox" id="usecase-screening" value="screening">
                                <label for="usecase-screening">Sanctions, PEPs & Adverse Media Screening & Monitoring</label>
                                <div class="description">Comprehensive watchlist checks, politically exposed persons, and negative news screening with ongoing monitoring</div>
                            </div>
                            <div class="checkbox-card" onclick="toggleCheckbox('usecase-agent')">
                                <input type="checkbox" id="usecase-agent" value="agent">
                                <label for="usecase-agent">Screening Agent</label>
                                <div class="description">Our screening agent classifies each screening match and provides a clear, audit-ready explanation, empowering analysts to make informed final decisions</div>
                            </div>
                            <div class="checkbox-card" onclick="toggleCheckbox('usecase-idd')">
                                <input type="checkbox" id="usecase-idd" value="idd">
                                <label for="usecase-idd">IDD Reporting Agent</label>
                                <div class="description">Comprehensive due diligence reports</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>üí° Tip:</strong> Most customers use Entity Data + Screening together. IDD reports are typically for high-risk or high-value cases.
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="previousStep()">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep()">Next ‚Üí</button>
                    </div>
                </div>
                
                <!-- Step 3: Access Package Selection -->
                <div class="step-content" data-step="3">
                    <h2>Which Access Package Best Fits Their Needs?</h2>
                    <p class="subtitle">Choose based on delivery requirements and workflow customization needs</p>
                    
                    <div class="question-group">
                        <label class="question-label">Access Package</label>
                        <div class="radio-group">
                            <div class="radio-card" onclick="selectDeployment('integrate')">
                                <input type="radio" name="deployment" value="integrate" id="deploy-integrate">
                                <div class="title">Integrate</div>
                                <div class="description">API & MCP access. Headless delivery for embedded workflows. For developers and API-first integrators.</div>
                            </div>
                            <div class="radio-card" onclick="selectDeployment('express')">
                                <input type="radio" name="deployment" value="express" id="deploy-express">
                                <div class="title">Express</div>
                                <div class="description">+ Platform UI with preconfigured workflows. Best-practice logic out of the box. For small law firms and SMBs.</div>
                            </div>
                            <div class="radio-card" onclick="selectDeployment('scale')">
                                <input type="radio" name="deployment" value="scale" id="deploy-scale">
                                <div class="title">Scale</div>
                                <div class="description">+ Custom Workflow Builder. Mirror your compliance manual and SOPs. For Tier 2 banks and corporates.</div>
                            </div>
                            <div class="radio-card" onclick="selectDeployment('enterprise')">
                                <input type="radio" name="deployment" value="enterprise" id="deploy-enterprise">
                                <div class="title">Enterprise</div>
                                <div class="description">+ Bulk data feeds, unlimited connectors, dedicated support. For Tier 1 global banks.</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info" id="deployment-guidance">
                        <strong>üí° Recommendation:</strong> <span id="deployment-recommendation">Select an access package to see guidance</span>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="previousStep()">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep()">Next ‚Üí</button>
                    </div>
                </div>
                
                <!-- Step 4: Volume Estimation -->
                <div class="step-content" data-step="4">
                    <h2>Volume Estimation</h2>
                    <p class="subtitle">Estimate annual volumes to calculate usage requirements</p>
                    
                    <!-- Show selected use cases -->
                    <div style="background: #f0f9ff; border: 2px solid #0ea5e9; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
                        <div style="font-weight: 700; color: #0369a1; margin-bottom: 8px; font-size: 14px;">‚úì SELECTED CAPABILITIES:</div>
                        <div id="selected-usecases-display" style="display: flex; flex-wrap: wrap; gap: 8px;">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="question-group">
                        <label class="question-label">Entities per Year</label>
                        <div class="input-group">
                            <input type="number" id="volume-entities" placeholder="e.g., 12000" min="0" oninput="calculateConsumption()">
                            <span>entities/year</span>
                        </div>
                        <div class="help-text">How many unique entities will they work with annually?</div>
                    </div>
                    
                    <div class="question-group" id="screening-volume-group" style="display:none;">
                        <label class="question-label">Entities to Screen & Monitor per Year</label>
                        <div class="input-group">
                            <input type="number" id="volume-screening" placeholder="e.g., 12000" min="0" oninput="calculateConsumption()">
                            <span>entities/year</span>
                        </div>
                        <div class="help-text">How many entities (including individuals) need sanctions, PEPs & adverse media screening annually?</div>
                    </div>
                    
                    
                    
                    <div class="question-group" id="idd-volume-group" style="display:none;">
                        <label class="question-label">IDD Reports per Year</label>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                            <div>
                                <label style="font-size: 14px; font-weight: 600; color: #475569; margin-bottom: 8px; display: block;">Lite Reports</label>
                                <div class="input-group">
                                    <input type="number" id="volume-idd-lite" placeholder="e.g., 30" min="0" oninput="calculateConsumption()">
                                    <span>reports/year</span>
                                </div>
                                <div class="help-text">Quick summaries, ~$150-500 each</div>
                            </div>
                            
                            <div>
                                <label style="font-size: 14px; font-weight: 600; color: #475569; margin-bottom: 8px; display: block;">Full Reports</label>
                                <div class="input-group">
                                    <input type="number" id="volume-idd-full" placeholder="e.g., 20" min="0" oninput="calculateConsumption()">
                                    <span>reports/year</span>
                                </div>
                                <div class="help-text">Comprehensive investigation, ~$450-1,500 each</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="consumption-preview" id="consumption-preview" style="display:none;">
                        <h4>üí∞ Estimated Consumption (with volume discount applied)</h4>
                        <div style="background: #fff3cd; padding: 12px; border-radius: 6px; margin-bottom: 15px; font-size: 13px; color: #856404;">
                            <strong>How it works:</strong> Your usage allowance works toward all capabilities ‚Äî including new AI agents as Moody's releases them. Higher volumes = better unit economics!
                        </div>
                        <div id="consumption-breakdown"></div>
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 2px solid #e2e8f0;">
                            <div class="consumption-item">
                                <span class="label"><strong>Annual Consumption (discounted):</strong></span>
                                <span class="value" id="annual-consumption" style="font-size: 18px; color: var(--navy-blue);">$0</span>
                            </div>
                            <div class="consumption-item">
                                <span class="label"><strong>Recommended Usage Allowance Level:</strong></span>
                                <span class="value" id="recommended-tier">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="previousStep()">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep()">Generate Quote ‚Üí</button>
                    </div>
                </div>
                
                <!-- Step 5: Quote Summary -->
                <div class="step-content" data-step="5">
                    <h2>üìã Quote Summary</h2>
                    <p class="subtitle">Review and finalize the package</p>
                    
                    <div class="summary-section">
                        <h3>Customer Name (Optional)</h3>
                        <input type="text" id="quoteCompanyName" placeholder="Enter customer name for quote..." style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
                    </div>
                    
                    <div class="summary-section">
                        <h3>Use Cases</h3>
                        <div id="summary-usecases"></div>
                    </div>
                    
                    <div class="summary-section">
                        <h3>Volume & Consumption</h3>
                        <div class="summary-item">
                            <span class="summary-label">Annual Entities (requiring entity data):</span>
                            <span class="summary-value" id="summary-volume">-</span>
                        </div>
                        <div class="summary-item" id="summary-screening-volume-item" style="display:none;">
                            <span class="summary-label">Annual Entities (including individuals, requiring screening data):</span>
                            <span class="summary-value" id="summary-screening-volume">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Estimated Annual Consumption:</span>
                            <span class="summary-value" id="summary-consumption">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Usage Allowance Level:</span>
                            <span class="summary-value" id="summary-usage-tier">-</span>
                        </div>
                    </div>
                    
                    <div class="pricing-card">
                        <h3>üíé Recommended Package</h3>
                        <div class="pricing-breakdown">
                            <div class="pricing-row">
                                <span>Usage Allowance (<span id="final-tier-name">-</span>)</span>
                                <span id="final-usage-price">$0</span>
                            </div>
                            <div class="pricing-row">
                                <span>Access Package (<span id="final-deployment-name">-</span>)</span>
                                <span id="final-deployment-price">$0</span>
                            </div>
                            <div class="pricing-row total">
                                <span>TOTAL ANNUAL PRICE</span>
                                <span id="final-total-price">$0</span>
                            </div>
                        </div>
                        <div style="text-align: center; font-size: 12px; color: rgba(255,255,255,0.7); margin-top: 12px; font-style: italic;">
                            All pricing shown is illustrative only
                        </div>
                    </div>
                    
                    <div class="summary-section">
                        <h3>What's Included</h3>
                        <div id="whats-included"></div>
                    </div>
                    
                    <div class="alert alert-warning" id="overage-alert" style="display:none;">
                        <strong>‚ö†Ô∏è Usage Alert:</strong> <span id="overage-message"></span>
                    </div>
                    
                    <div class="final-actions">
                        <button class="btn btn-secondary" onclick="previousStep()">‚Üê Back to Edit</button>
                        <button class="btn btn-primary" onclick="nextStep()">View ROI Analysis ‚Üí</button>
                    </div>
                </div>
                
                <!-- Step 6: ROI Estimator -->
                <div class="step-content" data-step="6">
                    <h2>üí∞ ROI Analysis: Moody's vs. Build-It-Yourself</h2>
                    <p class="subtitle">See how much time and money you save with Moody's for Compliance</p>
                    
                    <div class="alert alert-warning" style="background: #fef3c7; border-left-color: #f59e0b;">
                        <strong style="color: #92400e;">‚ö†Ô∏è ILLUSTRATIVE ONLY:</strong> <span style="color: #78350f;">All ROI calculations below are for illustration purposes only and are based on assumed benchmarks.</span>
                    </div>
                    
                    <div class="alert alert-info" style="margin-top: 10px;">
                        <strong>üìä Assumptions:</strong> Compliance Analyst: $65/hour fully loaded ‚Ä¢ Entity research: 30 mins/entity ‚Ä¢ Screening: 15 mins/entity ‚Ä¢ Match review: 20 mins/entity ‚Ä¢ IDD report: 8 hours/report
                    </div>
                    
                    <!-- ROI Comparison Cards -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
                        <!-- DIY Cost Card -->
                        <div style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-radius: 12px; padding: 30px; border: 2px solid #ef4444;">
                            <h3 style="color: #991b1b; font-size: 24px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 32px;">üî®</span> Build-It-Yourself Cost
                            </h3>
                            
                            <div id="diy-breakdown" style="margin-bottom: 20px;">
                                <!-- Will be populated by JavaScript -->
                            </div>
                            
                            <div style="background: white; padding: 20px; border-radius: 8px; margin-top: 20px;">
                                <div style="font-size: 14px; color: #991b1b; font-weight: 600; margin-bottom: 8px;">TOTAL ANNUAL DIY COST:</div>
                                <div style="font-size: 36px; font-weight: 700; color: #dc2626;" id="diy-total-cost">$0</div>
                            </div>
                        </div>
                        
                        <!-- Moody's Cost Card -->
                        <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-radius: 12px; padding: 30px; border: 2px solid #3b82f6;">
                            <h3 style="color: #1e40af; font-size: 24px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 32px;">‚ú®</span> Moody's for Compliance
                            </h3>
                            
                            <div id="moodys-breakdown" style="margin-bottom: 20px;">
                                <!-- Will be populated by JavaScript -->
                            </div>
                            
                            <div style="background: white; padding: 20px; border-radius: 8px; margin-top: 20px;">
                                <div style="font-size: 14px; color: #1e40af; font-weight: 600; margin-bottom: 8px;">TOTAL ANNUAL COST:</div>
                                <div style="font-size: 36px; font-weight: 700; color: #2563eb;" id="moodys-total-cost">$0</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Savings Highlight -->
                    <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 40px; border-radius: 16px; text-align: center; margin: 30px 0;">
                        <div style="font-size: 48px; margin-bottom: 10px;">üíé</div>
                        <div style="font-size: 20px; font-weight: 600; margin-bottom: 15px; opacity: 0.95;">YOUR SAVINGS WITH MOODY'S</div>
                        <div style="font-size: 56px; font-weight: 700; margin-bottom: 10px;" id="total-savings">$0</div>
                        <div style="font-size: 18px; opacity: 0.9;" id="roi-percentage">0% ROI</div>
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid rgba(255,255,255,0.3); font-size: 16px; opacity: 0.95;" id="time-savings">
                            Plus: Save <strong id="hours-saved">0</strong> hours of analyst time annually
                        </div>
                    </div>
                    
                    <!-- Key Benefits -->
                    <div style="background: #f8fafc; padding: 30px; border-radius: 12px; margin: 30px 0;">
                        <h3 style="color: #1e293b; font-size: 20px; margin-bottom: 20px;">‚úÖ What You Get Beyond Cost Savings:</h3>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                            <div style="font-size: 15px; color: #475569;"><strong style="color: var(--navy-blue);">‚Ä¢</strong> Instant access to premium data sources</div>
                            <div style="font-size: 15px; color: #475569;"><strong style="color: var(--navy-blue);">‚Ä¢</strong> AI-powered automation & screening</div>
                            <div style="font-size: 15px; color: #475569;"><strong style="color: var(--navy-blue);">‚Ä¢</strong> Always up-to-date sanctions lists</div>
                            <div style="font-size: 15px; color: #475569;"><strong style="color: var(--navy-blue);">‚Ä¢</strong> No infrastructure maintenance</div>
                            <div style="font-size: 15px; color: #475569;"><strong style="color: var(--navy-blue);">‚Ä¢</strong> Compliance-ready audit trails</div>
                            <div style="font-size: 15px; color: #475569;"><strong style="color: var(--navy-blue);">‚Ä¢</strong> Moody's brand credibility</div>
                        </div>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="previousStep()">‚Üê Back to Quote</button>
                        <button class="btn btn-primary" onclick="copyQuote()">üìã Copy Summary with ROI</button>
                        <button class="btn btn-success" onclick="exportQuote()">üìÑ Export Full Quote with ROI</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let currentStep = 1;
        let configData = {
            useCases: [],
            volumes: {},
            deployment: '',
            customerSize: '',
            region: '',
            consumption: 0,
            consumptionAtList: 0,
            tier: '',
            tierKey: '',
            discountRate: 0,
            usageAllowance: 0,
            deploymentFee: 0
        };
        
        // Pricing data
        // Pricing data - list is 100%, pro is 85% (15% off), bus is 70% (30% off), scale is 50% (50% off), ent5 is 40% (60% off), ent is 30% (70% off)
        const pricing = {
            curated: { list: 15, pro: 12.75, bus: 10.50, scale: 7.50, ent5: 6.00, ent: 4.50 },
            enhanced: { list: 22.5, pro: 19.125, bus: 15.75, scale: 11.25, ent5: 9.00, ent: 6.75 },
            sanctions: { list: 0.30, pro: 0.26, bus: 0.21, scale: 0.15, ent5: 0.12, ent: 0.09 },
            peps: { list: 0.50, pro: 0.43, bus: 0.35, scale: 0.25, ent5: 0.20, ent: 0.15 },
            adverse: { list: 1.00, pro: 0.85, bus: 0.70, scale: 0.50, ent5: 0.40, ent: 0.30 },
            agent: { list: 1.20, pro: 1.02, bus: 0.84, scale: 0.60, ent5: 0.48, ent: 0.36 },
            iddLite: { list: 500, pro: 425, bus: 350, scale: 250, ent5: 200, ent: 150 },
            iddFull: { list: 1500, pro: 1275, bus: 1050, scale: 750, ent5: 600, ent: 450 }
        };
        
        // Base access package fees
        const baseDeploymentFees = {
            'integrate': 10000,
            'express': 25000,
            'scale': 75000,
            'enterprise': 150000
        };
        
        // Customer size multipliers
        const sizeMultipliers = {
            'small': { multiplier: 1.0, label: 'Under $1B' },
            'medium': { multiplier: 1.5, label: '$1B ‚Äì $10B' },
            'large': { multiplier: 2.0, label: '$10B ‚Äì $50B' },
            'xlarge': { multiplier: 3.0, label: 'Over $50B' }
        };
        
        // Region multiplier
        const regionMultipliers = {
            'single': { multiplier: 1.0, label: 'Single Region' },
            'multi': { multiplier: 1.25, label: 'Multi-Region (+25%)' }
        };
        
        function selectCustomerSize(size) {
            document.querySelectorAll('input[name="customerSize"]').forEach(radio => {
                radio.checked = false;
                const card = radio.closest('.radio-card');
                if (card) card.classList.remove('selected');
            });
            
            const selected = document.getElementById(`size-${size}`);
            if (selected) {
                selected.checked = true;
                const card = selected.closest('.radio-card');
                if (card) card.classList.add('selected');
            }
            
            configData.customerSize = size;
            calculateAccessPackagePrice();
        }
        
        function selectRegion(region) {
            document.querySelectorAll('input[name="region"]').forEach(radio => {
                radio.checked = false;
                const card = radio.closest('.radio-card');
                if (card) card.classList.remove('selected');
            });
            
            const selected = document.getElementById(`region-${region}`);
            if (selected) {
                selected.checked = true;
                const card = selected.closest('.radio-card');
                if (card) card.classList.add('selected');
            }
            
            configData.region = region;
            calculateAccessPackagePrice();
        }
        
        function calculateAccessPackagePrice() {
            // Need all three selections to calculate
            if (!configData.deployment || !configData.customerSize || !configData.region) {
                return;
            }
            
            const basePrice = baseDeploymentFees[configData.deployment];
            const sizeMultiplier = sizeMultipliers[configData.customerSize].multiplier;
            const regionMultiplier = regionMultipliers[configData.region].multiplier;
            
            const calculatedPrice = basePrice * sizeMultiplier * regionMultiplier;
            
            // Store for use in quote generation
            configData.deploymentFee = calculatedPrice;
        }
        
        function selectRadio(name, value) {
            // Remove selected from all cards with this radio name
            document.querySelectorAll(`input[name="${name}"]`).forEach(radio => {
                radio.checked = false;
                const card = radio.closest('.radio-card');
                if (card) card.classList.remove('selected');
            });
            
            // Find and select the target
            const selected = document.getElementById(`${name}-${value}`);
            if (selected) {
                selected.checked = true;
                const card = selected.closest('.radio-card');
                if (card) card.classList.add('selected');
            }
        }
        
        function toggleCheckbox(id) {
            const checkbox = document.getElementById(id);
            if (!checkbox) return;
            
            checkbox.checked = !checkbox.checked;
            const card = checkbox.closest('.checkbox-card');
            if (card) {
                card.classList.toggle('selected', checkbox.checked);
            }
            
            // Update use cases
            const value = checkbox.value;
            if (checkbox.checked) {
                if (!configData.useCases.includes(value)) {
                    configData.useCases.push(value);
                }
            } else {
                configData.useCases = configData.useCases.filter(v => v !== value);
            }
            
            // Debug logging
            console.log('Selected use cases:', configData.useCases);
            
            // Show/hide volume inputs
            updateVolumeInputs();
        }
        
        function updateVolumeInputs() {
            document.getElementById('screening-volume-group').style.display = 
                configData.useCases.includes('screening') ? 'block' : 'none';
            document.getElementById('idd-volume-group').style.display = 
                configData.useCases.includes('idd') ? 'block' : 'none';
        }
        
        function calculateConsumption() {
            const entities = parseInt(document.getElementById('volume-entities').value) || 0;
            
            console.log('Calculate consumption called. Entities:', entities, 'Use cases:', configData.useCases);
            
            if (entities === 0) {
                document.getElementById('consumption-preview').style.display = 'none';
                return;
            }
            
            // Check if any use cases are selected
            if (configData.useCases.length === 0) {
                document.getElementById('consumption-preview').style.display = 'none';
                return;
            }
            
            document.getElementById('consumption-preview').style.display = 'block';
            
            // STEP 1: Calculate at LIST RATES to determine tier qualification
            let annualTotalAtList = 0;
            let breakdown = '';
            
            // Standard Entity Data
            if (configData.useCases.includes('entity')) {
                annualTotalAtList += entities * pricing.curated.list;
            }
            
            // Enhanced Entity Data
            if (configData.useCases.includes('registry')) {
                annualTotalAtList += entities * pricing.enhanced.list;
            }
            
            // Screening (Sanctions, PEPs & Adverse Media combined)
            if (configData.useCases.includes('screening')) {
                const screeningEntities = parseInt(document.getElementById('volume-screening').value) || entities;
                // All three screening types combined into one
                annualTotalAtList += screeningEntities * (pricing.sanctions.list + pricing.peps.list + pricing.adverse.list);
            }
            
            // Agent decisions (assume 1 screen = 1 decision if screening is selected)
            if (configData.useCases.includes('agent')) {
                let agentCount;
                if (configData.useCases.includes('screening')) {
                    // If screening is selected, use screening volume (1 screen = 1 decision)
                    agentCount = parseInt(document.getElementById('volume-screening').value) || entities;
                } else {
                    // Otherwise use total entities
                    agentCount = entities;
                }
                annualTotalAtList += agentCount * pricing.agent.list;
            }
            
            // IDD Reports (now annual)
            if (configData.useCases.includes('idd')) {
                const iddLiteCount = parseInt(document.getElementById('volume-idd-lite').value) || 0;
                const iddFullCount = parseInt(document.getElementById('volume-idd-full').value) || 0;
                
                annualTotalAtList += (iddLiteCount * pricing.iddLite.list) + (iddFullCount * pricing.iddFull.list);
            }
            
            const annualConsumptionAtList = annualTotalAtList;
            
            // STEP 2: Determine level based on LIST RATE consumption
            // The level (and discount) is determined by where list consumption falls
            let tierKey = 'list';
            let tierName = '';
            let tierBadge = '';
            let discountRate = 0;
            
            if (annualConsumptionAtList < 50000) {
                tierKey = 'list';
                tierName = 'Level 1 (0% discount)';
                tierBadge = '<span class="tier-badge">Level 1</span>';
                discountRate = 0;
            } else if (annualConsumptionAtList < 150000) {
                tierKey = 'pro';
                tierName = 'Level 2 (15% discount)';
                tierBadge = '<span class="tier-badge tier-professional">Level 2 -15%</span>';
                discountRate = 0.15;
            } else if (annualConsumptionAtList < 400000) {
                tierKey = 'bus';
                tierName = 'Level 3 (30% discount)';
                tierBadge = '<span class="tier-badge tier-business">Level 3 -30%</span>';
                discountRate = 0.30;
            } else if (annualConsumptionAtList < 750000) {
                tierKey = 'scale';
                tierName = 'Level 4 (50% discount)';
                tierBadge = '<span class="tier-badge tier-scale">Level 4 -50%</span>';
                discountRate = 0.50;
            } else if (annualConsumptionAtList < 1000000) {
                tierKey = 'ent5';
                tierName = 'Level 5 (60% discount)';
                tierBadge = '<span class="tier-badge tier-enterprise">Level 5 -60%</span>';
                discountRate = 0.60;
            } else {
                tierKey = 'ent';
                tierName = 'Level 6 (70% discount)';
                tierBadge = '<span class="tier-badge tier-enterprise">Level 6 -70%</span>';
                discountRate = 0.70;
            }
            
            // STEP 3: Re-calculate consumption at DISCOUNTED RATES
            let annualTotalDiscounted = 0;
            
            // Standard Entity Data with discount
            if (configData.useCases.includes('entity')) {
                const entityCost = pricing.curated[tierKey];
                const annualCost = entities * entityCost;
                annualTotalDiscounted += annualCost;
                console.log('Adding Standard Entity Data:', entities, 'entities @', entityCost, '= $', annualCost);
                breakdown += `<div class="consumption-item">
                    <span class="label">${entities.toLocaleString()} Standard Entity profiles @ $${entityCost.toFixed(2)}</span>
                    <span class="value">$${annualCost.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                </div>`;
            }
            
            // Enhanced Entity Data with discount
            if (configData.useCases.includes('registry')) {
                const entityCost = pricing.enhanced[tierKey];
                const annualCost = entities * entityCost;
                annualTotalDiscounted += annualCost;
                console.log('Adding Enhanced Entity Data:', entities, 'entities @', entityCost, '= $', annualCost);
                breakdown += `<div class="consumption-item">
                    <span class="label">${entities.toLocaleString()} Enhanced Entity profiles @ $${entityCost.toFixed(2)}</span>
                    <span class="value">$${annualCost.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                </div>`;
            }
            
            // Screening with discount (Sanctions, PEPs & Adverse Media combined)
            if (configData.useCases.includes('screening')) {
                const screeningEntities = parseInt(document.getElementById('volume-screening').value) || entities;
                const combinedRate = pricing.sanctions[tierKey] + pricing.peps[tierKey] + pricing.adverse[tierKey];
                const annualCost = screeningEntities * combinedRate;
                annualTotalDiscounted += annualCost;
                breakdown += `<div class="consumption-item">
                    <span class="label">${screeningEntities.toLocaleString()} Sanctions, PEPs & Adverse Media screens @ $${combinedRate.toFixed(2)}</span>
                    <span class="value">$${annualCost.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                </div>`;
            }
            
            // Agent decisions with discount
            if (configData.useCases.includes('agent')) {
                let agentCount;
                if (configData.useCases.includes('screening')) {
                    // If screening is selected, use screening volume (1 screen = 1 decision)
                    agentCount = parseInt(document.getElementById('volume-screening').value) || entities;
                } else {
                    // Otherwise use total entities
                    agentCount = entities;
                }
                const annualCost = agentCount * pricing.agent[tierKey];
                annualTotalDiscounted += annualCost;
                breakdown += `<div class="consumption-item">
                    <span class="label">${agentCount.toLocaleString()} Screening Agent decisions @ $${pricing.agent[tierKey].toFixed(2)}</span>
                    <span class="value">$${annualCost.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                </div>`;
            }
            
            // IDD Reports with discount
            if (configData.useCases.includes('idd')) {
                const iddLiteCount = parseInt(document.getElementById('volume-idd-lite').value) || 0;
                const iddFullCount = parseInt(document.getElementById('volume-idd-full').value) || 0;
                
                if (iddLiteCount > 0) {
                    const annualCost = iddLiteCount * pricing.iddLite[tierKey];
                    annualTotalDiscounted += annualCost;
                    breakdown += `<div class="consumption-item">
                        <span class="label">${iddLiteCount.toLocaleString()} IDD Lite reports @ $${pricing.iddLite[tierKey].toLocaleString()}</span>
                        <span class="value">$${annualCost.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                    </div>`;
                }
                
                if (iddFullCount > 0) {
                    const annualCost = iddFullCount * pricing.iddFull[tierKey];
                    annualTotalDiscounted += annualCost;
                    breakdown += `<div class="consumption-item">
                        <span class="label">${iddFullCount.toLocaleString()} IDD Full reports @ $${pricing.iddFull[tierKey].toLocaleString()}</span>
                        <span class="value">$${annualCost.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                    </div>`;
                }
            }
            
            const annualConsumptionDiscounted = annualTotalDiscounted;
            
            // Store both values
            configData.consumption = annualConsumptionDiscounted;
            configData.consumptionAtList = annualConsumptionAtList;
            configData.tier = tierName;
            configData.tierKey = tierKey;
            configData.discountRate = discountRate;
            
            document.getElementById('consumption-breakdown').innerHTML = breakdown;
            document.getElementById('annual-consumption').textContent = '$' + Math.round(annualConsumptionDiscounted).toLocaleString();
            document.getElementById('recommended-tier').innerHTML = tierName + ' ' + tierBadge;
            
            // Store screening volume if screening is selected
            const screeningVolume = configData.useCases.includes('screening') 
                ? (parseInt(document.getElementById('volume-screening').value) || entities)
                : null;
            
            configData.volumes = {
                entities: entities,
                screeningEntities: screeningVolume,
                annualConsumption: annualConsumptionDiscounted,
                annualConsumptionAtList: annualConsumptionAtList
            };
        }
        
        function selectDeployment(type) {
            // Clear all selections
            document.querySelectorAll('input[name="deployment"]').forEach(radio => {
                radio.checked = false;
                const card = radio.closest('.radio-card');
                if (card) card.classList.remove('selected');
            });
            
            // Select the clicked one
            const selected = document.getElementById(`deploy-${type}`);
            if (selected) {
                selected.checked = true;
                const card = selected.closest('.radio-card');
                if (card) card.classList.add('selected');
            }
            
            configData.deployment = type;
            
            // Update guidance
            const guidance = document.getElementById('deployment-recommendation');
            let message = '';
            
            if (type === 'integrate') {
                message = 'For engineering-led teams who need our data but not our UI. Best for firms building their own tools or integrating AI agents directly into an existing internal platform via API or MCP. Select this when the goal is pure automation rather than human case management.';
            } else if (type === 'express') {
                message = 'Best for small-to-midsize firms needing a turnkey, out-of-the-box solution. It provides a ready-to-use platform UI with preconfigured best-practice workflows, allowing teams to start screening immediately. Select this for "Speed to Value" when the firm\'s process can adapt to our standard logic.';
            } else if (type === 'scale') {
                message = 'Designed for Tier 2 Banks and large Corporates with specific internal compliance manuals. It unlocks the Custom Workflow Builder, allowing the platform to mirror proprietary risk policies and unique SOPs. Select this when the client needs the software to adapt to their specific policy.';
            } else if (type === 'enterprise') {
                message = 'Reserved for Tier 1 Global Banks and high-scale institutions. It provides the infrastructure for bulk data feeds, unlimited connectors, and dedicated strategic support. Select this for global deployments requiring maximum data throughput and white-glove account management.';
            }
            
            guidance.textContent = message;
            
            // Recalculate access package price
            calculateAccessPackagePrice();
        }
        
        function calculateROI() {
            const entities = parseInt(document.getElementById('volume-entities').value) || 0;
            const screeningEntities = parseInt(document.getElementById('volume-screening')?.value) || entities;
            const iddLiteCount = parseInt(document.getElementById('volume-idd-lite')?.value) || 0;
            const iddFullCount = parseInt(document.getElementById('volume-idd-full')?.value) || 0;
            const totalIddCount = iddLiteCount + iddFullCount;
            
            // Realistic industry benchmarks
            const ANALYST_HOURLY_RATE = 65; // Compliance analyst fully loaded cost: $135k/year √∑ 2080 hours
            
            // Time estimates - what Moody's automation replaces
            const ENTITY_RESEARCH_MINS = 30; // Manual entity lookup, verification, structure mapping per entity
            const SCREENING_MINS = 15; // Setting up and running manual screens per entity
            const MATCH_REVIEW_MINS = 20; // Reviewing screening results and documenting decisions per entity
            const IDD_REPORT_HOURS = 8; // Hours to manually compile comprehensive IDD report
            
            // Data subscription costs if doing it yourself (annual)
            const DATA_SUBSCRIPTIONS_BASE = 25000; // Base cost for entity data sources
            const SCREENING_SUBSCRIPTIONS = 35000; // Sanctions, PEP, adverse media data feeds
            
            // Calculate DIY costs
            let diyStaffCost = 0;
            let diyDataCost = 0;
            let totalHours = 0;
            let breakdownHTML = '';
            
            // Entity research (what Standard/Enhanced Entity Data replaces)
            if (configData.useCases.includes('entity') || configData.useCases.includes('registry')) {
                const entityHours = (entities * ENTITY_RESEARCH_MINS) / 60;
                const entityStaffCost = entityHours * ANALYST_HOURLY_RATE;
                
                diyStaffCost += entityStaffCost;
                diyDataCost += DATA_SUBSCRIPTIONS_BASE;
                totalHours += entityHours;
                
                breakdownHTML += `
                    <div style="font-size: 14px; color: #7f1d1d; margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <strong>Entity Research & Verification:</strong><br>
                        ‚Ä¢ ${entities.toLocaleString()} entities √ó ${ENTITY_RESEARCH_MINS} mins = ${Math.round(entityHours).toLocaleString()} hours<br>
                        ‚Ä¢ Staff cost @ $${ANALYST_HOURLY_RATE}/hr: $${Math.round(entityStaffCost).toLocaleString()}<br>
                        ‚Ä¢ Data subscriptions: $${DATA_SUBSCRIPTIONS_BASE.toLocaleString()}
                    </div>
                `;
            }
            
            // Screening (what Sanctions/PEPs/Adverse Media replaces)
            if (configData.useCases.includes('screening')) {
                const screeningHours = (screeningEntities * SCREENING_MINS) / 60;
                const screeningStaffCost = screeningHours * ANALYST_HOURLY_RATE;
                
                diyStaffCost += screeningStaffCost;
                diyDataCost += SCREENING_SUBSCRIPTIONS;
                totalHours += screeningHours;
                
                breakdownHTML += `
                    <div style="font-size: 14px; color: #7f1d1d; margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <strong>Screening Setup & Execution:</strong><br>
                        ‚Ä¢ ${screeningEntities.toLocaleString()} screens √ó ${SCREENING_MINS} mins = ${Math.round(screeningHours).toLocaleString()} hours<br>
                        ‚Ä¢ Staff cost @ $${ANALYST_HOURLY_RATE}/hr: $${Math.round(screeningStaffCost).toLocaleString()}<br>
                        ‚Ä¢ Screening data subscriptions: $${SCREENING_SUBSCRIPTIONS.toLocaleString()}
                    </div>
                `;
            }
            
            // Agent (what Screening Agent replaces - match review time)
            if (configData.useCases.includes('agent')) {
                const agentCount = configData.useCases.includes('screening') ? screeningEntities : entities;
                const matchReviewHours = (agentCount * MATCH_REVIEW_MINS) / 60;
                const matchReviewCost = matchReviewHours * ANALYST_HOURLY_RATE;
                
                diyStaffCost += matchReviewCost;
                totalHours += matchReviewHours;
                
                breakdownHTML += `
                    <div style="font-size: 14px; color: #7f1d1d; margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <strong>Match Review & Decision Documentation:</strong><br>
                        ‚Ä¢ ${agentCount.toLocaleString()} reviews √ó ${MATCH_REVIEW_MINS} mins = ${Math.round(matchReviewHours).toLocaleString()} hours<br>
                        ‚Ä¢ Staff cost @ $${ANALYST_HOURLY_RATE}/hr: $${Math.round(matchReviewCost).toLocaleString()}
                    </div>
                `;
            }
            
            // IDD Reports
            if (configData.useCases.includes('idd') && totalIddCount > 0) {
                const iddHours = totalIddCount * IDD_REPORT_HOURS;
                const iddStaffCost = iddHours * ANALYST_HOURLY_RATE;
                
                diyStaffCost += iddStaffCost;
                totalHours += iddHours;
                
                breakdownHTML += `
                    <div style="font-size: 14px; color: #7f1d1d; margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <strong>Manual IDD Report Creation:</strong><br>
                        ‚Ä¢ ${totalIddCount.toLocaleString()} reports √ó ${IDD_REPORT_HOURS} hours = ${Math.round(iddHours).toLocaleString()} hours<br>
                        ‚Ä¢ Staff cost @ $${ANALYST_HOURLY_RATE}/hr: $${Math.round(iddStaffCost).toLocaleString()}
                    </div>
                `;
            }
            
            const totalDIYCost = diyStaffCost + diyDataCost;
            
            // Populate DIY breakdown
            document.getElementById('diy-breakdown').innerHTML = breakdownHTML;
            document.getElementById('diy-total-cost').textContent = '$' + Math.round(totalDIYCost).toLocaleString();
            
            // Moody's breakdown
            const moodysTotalCost = configData.totalPrice || 0;
            const moodysBreakdown = `
                <div style="font-size: 14px; color: #1e40af; margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                    <strong>Access Package:</strong><br>
                    $${configData.deploymentFee.toLocaleString()}
                </div>
                <div style="font-size: 14px; color: #1e40af; margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                    <strong>Usage Allowance:</strong><br>
                    $${configData.usageAllowance.toLocaleString()}<br>
                    <small style="opacity: 0.8;">Covers ${entities.toLocaleString()} entities at ${Math.round(configData.discountRate * 100)}% discount</small>
                </div>
                <div style="font-size: 13px; color: #1e40af; margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.7); border-radius: 6px; border-left: 3px solid #3b82f6;">
                    <strong>Includes:</strong> Premium data ‚Ä¢ AI automation ‚Ä¢ Audit trails ‚Ä¢ Updates ‚Ä¢ Support
                </div>
            `;
            
            document.getElementById('moodys-breakdown').innerHTML = moodysBreakdown;
            document.getElementById('moodys-total-cost').textContent = '$' + moodysTotalCost.toLocaleString();
            
            // Calculate savings
            const savings = totalDIYCost - moodysTotalCost;
            const roiPercentage = moodysTotalCost > 0 ? ((savings / moodysTotalCost) * 100).toFixed(0) : 0;
            
            document.getElementById('total-savings').textContent = savings > 0 ? '$' + Math.round(savings).toLocaleString() : '-$' + Math.round(Math.abs(savings)).toLocaleString();
            document.getElementById('roi-percentage').textContent = roiPercentage + '% ROI';
            document.getElementById('hours-saved').textContent = Math.round(totalHours).toLocaleString();
            
            // Update savings display color based on positive/negative
            const savingsElement = document.getElementById('total-savings').parentElement;
            if (savings < 0) {
                savingsElement.style.background = 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)';
            }
            
            // Store ROI data for export
            configData.roiData = {
                diyCost: totalDIYCost,
                moodysCost: moodysTotalCost,
                savings: savings,
                roi: roiPercentage,
                hoursSaved: totalHours
            };
        }
        
        function nextStep() {
            // Validate current step
            if (currentStep === 1) {
                if (!configData.customerSize || !configData.region) {
                    alert('Please select customer size and geographic scope');
                    return;
                }
            }
            
            if (currentStep === 2) {
                if (configData.useCases.length === 0) {
                    alert('Please select at least one use case');
                    return;
                }
            }
            
            if (currentStep === 3) {
                if (!configData.deployment) {
                    alert('Please select an access package');
                    return;
                }
            }
            
            if (currentStep === 4) {
                if (!document.getElementById('volume-entities').value) {
                    alert('Please enter entity volume');
                    return;
                }
                calculateConsumption();
                calculateAccessPackagePrice();
                generateQuote();
            }
            
            if (currentStep === 5) {
                // Moving to ROI calculator
                calculateROI();
            }
            
            if (currentStep < 6) {
                currentStep++;
                updateStep();
            }
        }
        
        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStep();
            }
        }
        
        function updateStep() {
            // Update progress bar
            document.querySelectorAll('.progress-step').forEach(step => {
                const stepNum = parseInt(step.dataset.step);
                step.classList.remove('active', 'completed');
                if (stepNum === currentStep) {
                    step.classList.add('active');
                } else if (stepNum < currentStep) {
                    step.classList.add('completed');
                }
            });
            
            // Update content
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
                if (parseInt(content.dataset.step) === currentStep) {
                    content.classList.add('active');
                }
            });
            
            // If moving to step 4 (volume), show selected use cases and update volume inputs
            if (currentStep === 4) {
                updateSelectedUseCasesDisplay();
                updateVolumeInputs();
            }
            
            // Update navigation buttons
            const prevBtn = document.querySelector('.step-content.active .btn-secondary');
            if (prevBtn) {
                prevBtn.disabled = currentStep === 1;
            }
        }
        
        function updateSelectedUseCasesDisplay() {
            const labels = {
                entity: 'Standard Entity Data & Verification',
                registry: 'Enhanced Entity Data Verification',
                screening: 'Sanctions, PEPs & Adverse Media Screening & Monitoring',
                agent: 'Screening Agent',
                idd: 'IDD Reporting Agent'
            };
            
            const displayDiv = document.getElementById('selected-usecases-display');
            if (!displayDiv) return;
            
            const html = configData.useCases.map(uc => {
                return `<span style="background: #0ea5e9; color: white; padding: 6px 12px; border-radius: 6px; font-size: 13px; font-weight: 600;">${labels[uc]}</span>`;
            }).join('');
            
            displayDiv.innerHTML = html || '<span style="color: #64748b; font-style: italic;">No use cases selected</span>';
        }
        
        function generateQuote() {
            // Use cases
            const useCasesHtml = configData.useCases.map(uc => {
                const labels = {
                    entity: 'Standard Entity Data & Verification',
                    registry: 'Enhanced Entity Data Verification',
                    screening: 'Sanctions, PEPs & Adverse Media Screening & Monitoring',
                    agent: 'Screening Agent',
                    idd: 'IDD Reporting Agent'
                };
                return `<div class="summary-item">
                    <span class="summary-label">‚úì ${labels[uc]}</span>
                </div>`;
            }).join('');
            document.getElementById('summary-usecases').innerHTML = useCasesHtml;
            
            // Show entity volume (always)
            document.getElementById('summary-volume').textContent = 
                configData.volumes.entities.toLocaleString() + ' entities/year';
            
            // Show/hide and populate screening volume line item
            if (configData.useCases.includes('screening') && configData.volumes.screeningEntities !== null) {
                document.getElementById('summary-screening-volume-item').style.display = 'flex';
                document.getElementById('summary-screening-volume').textContent = 
                    configData.volumes.screeningEntities.toLocaleString() + ' entities/year';
            } else {
                document.getElementById('summary-screening-volume-item').style.display = 'none';
            }
            
            document.getElementById('summary-consumption').textContent = 
                '$' + Math.round(configData.volumes.annualConsumption).toLocaleString() + ' (at discounted rates)';
            document.getElementById('summary-usage-tier').textContent = configData.tier;
            
            // Calculate recommended usage allowance based on DISCOUNTED consumption
            // Simply round up the discounted consumption to nearest $5k
            const discountedConsumption = configData.volumes.annualConsumption;
            const listConsumption = configData.volumes.annualConsumptionAtList;
            
            // Round up to nearest $5k, with minimum of $10k
            let usageAllowance = Math.max(10000, Math.ceil(discountedConsumption / 5000) * 5000);
            
            // Format the allowance display
            let allowanceDisplay;
            if (usageAllowance >= 1000000) {
                allowanceDisplay = `$${(usageAllowance / 1000000).toFixed(1)}M`;
            } else {
                allowanceDisplay = `$${usageAllowance / 1000}k`;
            }
            
            const deploymentFee = configData.deploymentFee || baseDeploymentFees[configData.deployment];
            const totalPrice = usageAllowance + deploymentFee;
            
            configData.usageAllowance = usageAllowance;
            configData.totalPrice = totalPrice;
            
            // Update pricing card - use the tier/level from calculateConsumption
            document.getElementById('final-tier-name').textContent = allowanceDisplay + ' (' + configData.tier.split('(')[0].trim() + ')';
            document.getElementById('final-usage-price').textContent = '$' + usageAllowance.toLocaleString();
            
            const deploymentNames = {
                'integrate': 'Integrate (API & MCP)',
                'express': 'Express (Platform UI)',
                'scale': 'Scale (Custom Workflows)',
                'enterprise': 'Enterprise (Bulk + Dedicated)'
            };
            document.getElementById('final-deployment-name').textContent = deploymentNames[configData.deployment];
            document.getElementById('final-deployment-price').textContent = '$' + deploymentFee.toLocaleString();
            document.getElementById('final-total-price').textContent = '$' + totalPrice.toLocaleString();
            
            // What's included
            const included = {
                'integrate': ['Full REST API access', 'MCP Server access', 'API documentation & sandbox', 'Webhooks & event streaming', 'No Moody\'s UI (bring your own)', 'Technical support'],
                'express': ['Everything in Integrate', 'Moody\'s Platform UI', 'Preconfigured KYC/AML workflows', 'Preconfigured third-party risk workflows', 'Best-practice logic', 'Case management & collaboration', 'Audit trails & reporting', 'Standard support'],
                'scale': ['Everything in Express', 'Custom Workflow Builder', 'Edit workflow steps & risk weights', 'Mirror your compliance manual', 'Custom approval chains', 'Advanced rule engine', 'Investigation workflows', 'Network visualization', 'Priority support'],
                'enterprise': ['Everything in Scale', 'Bulk data feeds', 'Unlimited system connectors', 'Dedicated Customer Success Manager', 'Implementation support', 'Multi-region deployment options', 'Quarterly Business Reviews', 'Custom SLAs', '24/7 premium support']
            };
            
            const includedHtml = included[configData.deployment].map(item => 
                `<div class="summary-item"><span class="summary-label">‚úì ${item}</span></div>`
            ).join('');
            document.getElementById('whats-included').innerHTML = includedHtml;
            
            // Check for overage
            if (discountedConsumption > usageAllowance) {
                document.getElementById('overage-alert').style.display = 'block';
                const suggestedAllowance = Math.ceil(discountedConsumption / 5000) * 5000;
                document.getElementById('overage-message').textContent = 
                    `Estimated consumption ($${Math.round(discountedConsumption).toLocaleString()}) exceeds allowance. Consider increasing to $${(suggestedAllowance / 1000)}k.`;
            } else {
                document.getElementById('overage-alert').style.display = 'none';
            }
            
            // Add explanation of value
            const levelName = configData.tier.split('(')[0].trim();
            const valueExplanation = `
                <div style="background: linear-gradient(135deg, rgba(42, 161, 152, 0.1) 0%, rgba(27, 78, 133, 0.1) 100%); padding: 20px; border-radius: 8px; margin-top: 20px; border-left: 4px solid #2aa198;">
                    <strong style="color: #0b2545;">üí° Value Breakdown:</strong><br>
                    <div style="margin-top: 10px; font-size: 14px; color: #4a5568;">
                        ‚Ä¢ Your estimated consumption at list rates: <strong>$${Math.round(listConsumption).toLocaleString()}/year</strong><br>
                        ‚Ä¢ With ${levelName} discount (${Math.round(configData.discountRate * 100)}% off): <strong>$${Math.round(discountedConsumption).toLocaleString()}/year</strong><br>
                        ‚Ä¢ Recommended usage allowance: <strong>${allowanceDisplay}</strong><br>
                        ‚Ä¢ You're getting <strong>$${Math.round(listConsumption).toLocaleString()}</strong> worth of compliance actions for <strong>$${usageAllowance.toLocaleString()}</strong>
                    </div>
                </div>
            `;
            document.getElementById('whats-included').innerHTML += valueExplanation;
        }
        
        function exportQuote() {
            alert('PDF export functionality would integrate with your CRM/CPQ system. For now, use "Copy Summary" to paste into your proposal document.');
        }
        
        function copyQuote() {
            const companyName = document.getElementById('quoteCompanyName').value;
            
            // Get customer sizing labels
            const sizeLabel = configData.customerSize ? sizeMultipliers[configData.customerSize].label : 'Not specified';
            const regionLabel = configData.region ? regionMultipliers[configData.region].label : 'Not specified';
            const basePrice = configData.deployment ? baseDeploymentFees[configData.deployment] : 0;
            
            const summary = `
‚ö†Ô∏è ILLUSTRATIVE ONLY - All pricing and calculations are for illustration purposes only

MOODY'S FOR COMPLIANCE - SALES QUOTE
=====================================
${companyName ? `\nCustomer: ${companyName}\n` : ''}
CUSTOMER PROFILE:
- Customer Size: ${sizeLabel}
- Geographic Scope: ${regionLabel}

USE CASES:
${configData.useCases.map(uc => {
    const labels = {
        entity: 'Standard Entity Data & Verification',
        registry: 'Enhanced Entity Data Verification',
        screening: 'Sanctions, PEPs & Adverse Media Screening & Monitoring',
        agent: 'Screening Agent',
        idd: 'IDD Reporting Agent'
    };
    return `- ${labels[uc]}`;
}).join('\n')}

VOLUME:
- Annual Entities (requiring entity data): ${configData.volumes.entities.toLocaleString()}${configData.useCases.includes('screening') && configData.volumes.screeningEntities !== null 
    ? `\n- Annual Entities (including individuals, requiring screening data): ${configData.volumes.screeningEntities.toLocaleString()}`
    : ''}
- Estimated Annual Consumption (at list rates): $${Math.round(configData.volumes.annualConsumptionAtList).toLocaleString()}
- With ${configData.tier.split('(')[0].trim()} discount (${Math.round(configData.discountRate * 100)}% off): $${Math.round(configData.volumes.annualConsumption).toLocaleString()}
- Usage Allowance Level: ${configData.tier}

PRICING (ILLUSTRATIVE):
- Usage Allowance: $${configData.usageAllowance.toLocaleString()}
  (Covers $${Math.round(configData.volumes.annualConsumptionAtList).toLocaleString()} of list-rate consumption)
- Access Package (${configData.deployment}): $${configData.deploymentFee.toLocaleString()}
  (Base $${basePrice.toLocaleString()} adjusted for customer size and region)
- TOTAL ANNUAL: $${configData.totalPrice.toLocaleString()}

VALUE PROPOSITION:
You're getting $${Math.round(configData.volumes.annualConsumptionAtList).toLocaleString()} worth of compliance 
actions for $${configData.usageAllowance.toLocaleString()} - that's ${Math.round(configData.discountRate * 100)}% savings!

${configData.roiData ? `
ROI ANALYSIS (ILLUSTRATIVE):
- DIY Approach Cost: $${Math.round(configData.roiData.diyCost).toLocaleString()}/year
- Moody's for Compliance: $${Math.round(configData.roiData.moodysCost).toLocaleString()}/year
- Your Annual Savings: $${Math.round(configData.roiData.savings).toLocaleString()}
- Return on Investment: ${configData.roiData.roi}%
- Analyst Time Saved: ${Math.round(configData.roiData.hoursSaved).toLocaleString()} hours/year

VALUE BEYOND COST SAVINGS:
- Instant access to premium compliance data sources
- AI-powered automation and screening agents
- Always up-to-date sanctions and watchlists
- No infrastructure maintenance required
- Compliance-ready audit trails
- Moody's brand credibility with regulators
` : ''}
‚ö†Ô∏è DISCLAIMER: All figures are illustrative and do not represent actual commercial terms.
            `.trim();
            
            navigator.clipboard.writeText(summary).then(() => {
                alert('Quote summary copied to clipboard!');
            });
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateStep();
        });
    </script>
</body>
</html>
